function dayPart(){var e=new Date,t=e.getHours();return t>=0&&t<12?"Morning":t>=12&&t<17?"Afternoon":t>=17&&t<21?"Evening":"Night"}function initAbTest(){$(".featured-events .featured-event").each(function(e,t){e>=4&&$(this).css("display","none")}),$(".ab").show(),$(".notab").remove(),$(".merge-bg").css("background-color","#fff"),$(".adspot-content").find(".btn").css("background-color","#f4f4f4"),$(".adspot-content").find(".btn").mouseover(function(){$(this).css("background-color","#fff")}),$(".adspot-content").find(".btn").mouseout(function(){$(this).css("background-color","#f4f4f4")}),videosDataab.get()}function fnCheckWalletStatus(){try{BMS.Storage.isset({name:"ld"})&&"A"==BMS.Storage.get({name:"ld",key:"WALLETSTATUS"})?$("#btnWalletHome").html("ADD CASH"):$("#btnWalletHome").html("ACTIVATE MYWALLET"),$("#btnWalletHome").attr("href","/myprofile/mywallet/")}catch(e){BMS.Misc.fnErr({fnName:"fnCheckWalletStatus",err:e})}}function fnBookNow(e,t,n,o,s,r,c,l){BMS.Misc.fnBusy(!0),byWhat="ET";var d={},v={},u={},g=[],f=[],p=[];sessions=[],evtName="";var m={seatlayoutjs:"",seatlayouthtml:""};m.seatlayoutjs=$.getScript(getSeatScript,function(e,t,n){}),m.seatlayouthtml=$.ajax({type:"GET",url:"/serv/getData.bms",data:{cmd:"SEATHTML"}}),$.when(m.seatlayoutjs,m.seatlayouthtml).then(function(e,m){for(blnCallSeatHtml||($("body").append(m[0]),blnCallSeatHtml=!0),i=0;i<SeatData.length;i++)if(strVenName=SeatData[i].VenueName,o==SeatData[i].EventCode){for(var S in SeatData[i].Dates)for(var h in SeatData[i].Dates[S])S==r&&"undefined"!=typeof SeatData[i].Dates[S][h].SessionId&&(u[SeatData[i].Dates[S][h].SessionId]={id:SeatData[i].Dates[S][h].SessionId,time:SeatData[i].Dates[S][h].DisplayShowTime,dateTime:SeatData[i].Dates[S][h].DisplayShowDate,isAvailable:"Y",isAtmosEnabled:!1},p.push(u[SeatData[i].Dates[S][h].SessionId]));sessions.push(p),a=SeatData[i].EventTitle,a.indexOf("(U/A)")>1?evtName=a.replace("(U/A)",""):a.indexOf("(U)")!=-1?evtName=a.replace("(U)",""):a.indexOf("(A)")!=-1&&(evtName=a.replace("(A)","")),evtName=evtName.trim(),blnRecoVistaCine="Y"==SeatData[i].IsFullSeatLayout,d[SeatData[i].EventCode]={title:evtName,dimension:"",eventCode:SeatData[i].EventCode,language:SeatData[i].EventLang,isAtmosEnabled:SeatData[i].IsAtmosEnabled,censor:SeatData[i].EventCensor},v[t]={code:t,eventCode:o,name:SeatData[i].VenueName,appType:SeatData[i].VenueApp,isFullSeatLayout:blnRecoVistaCine,message:{type:SeatData[i].MessageType,title:SeatData[i].MessageTitle,body:SeatData[i].Message},sessions:p},g.push(d[SeatData[i].EventCode]),f.push(v[t])}var M={selected:{time:s,date:c,ssid:n,venueCode:t},event:g,venue:f};BMS.Misc.fnPushEventDataToAnalytics(["WR","KM"],"Clicked recommendation",{ProductID:o,"Event Type":"MT","Event Name":evtName,"Venue Name":strVenName,"Event Day":c,"Show time":s,"Event Date":c,Appcode:global.strAppCode}),"Y"==l?(BMS.Misc.fnBusy(!1),fnPopupSelSh("",t,n,o,s,M)):(BMS.Misc.fnBusy(!1),fnSelSh("",t,n,o,s,M));try{BMS.Misc.fnPushEventDataToAnalytics(["WR","KM"],"Selected showtime",{ProductID:o,"Event Type":"MT","Event Name":evtName,"Venue Name":strVenName,"Venue group":t,Genre:"",Language:"","Is Logged in":""!=BMS.Storage.get({name:"ld"})?"Yes":"No",Appcode:global.strAppCode,Page:"home",Showtime:s})}catch(w){}})}function showPosition(e){currentGeoLocation.geoLocation.lat=e.coords.latitude.toString(),currentGeoLocation.geoLocation.lng=e.coords.longitude.toString();var t=JSON.stringify(currentGeoLocation.geoLocation);render.showtimesRerender(),BMS.Storage.set({name:"geoLocation",value:t,sess:!0,expiry:3600})}function fnFavAdd(e){afterSignIn||(afterSignIn=!1);try{if(BMS.Storage.isset({name:"ld"})){try{$("#"+e).addClass("animated infinite pulse zoomIn")}catch(t){}setInterval(function(){$("#"+e).removeClass("animated infinite pulse zoomIn")},6e3);var n=BMS.Storage,a=(n.get({name:"ld"}),n.get({name:"ld",key:"MEMBEREMAIL"}),n.get({name:"ld",key:"LSID"})),i=n.get({name:"ld",key:"MEMBERID",defVal:""});BMS.Misc.fnDoSecureTrans({venCode:e,cmd:"SETPROFILE",p1:"SETFAVORITE",p2:i,p3:a,p4:e,fnCC:fnFavSuc,fnEC:fnFavFail})}else BMS.SignIn.fnSignIn(!0),void 0==global.SignInCallBack&&(global.SignInCallBack=[]),BMS.SignIn.fnRegister("showtimes",function(){afterSignIn=!0,fnFavAdd(e)})}catch(o){BMS.Misc.fnErr({fnName:"fnFavAdd",fnParams:e,err:o})}}function fnFavFail(t){BMS.Misc.fnErr({fnName:"fnFavFail",fnParams:t,err:e})}function fnFavRmv(e){try{if(BMS.Storage.isset({name:"ld"})){var t=BMS.Storage,n=(t.get({name:"ld"}),t.get({name:"ld",key:"MEMBEREMAIL"}),t.get({name:"ld",key:"LSID"})),a=t.get({name:"ld",key:"MEMBERID"});BMS.Misc.fnDoSecureTrans({venCode:e,cmd:"SETPROFILE",p1:"REMOVEFAVORITE",p2:a,p3:n,p4:e,fnCC:fnFavSuc,fnEC:fnFavFail}),$("#"+e).removeClass("_active"),$("#"+e).parent().parent().parent().removeClass("_favourited"),$("#"+e).attr("onclick","fnFavAdd('"+e+"');")}else void 0==global.SignInCallBack&&(global.SignInCallBack=[]),BMS.SignIn.fnRegister("showtimes",function(){afterSignIn=!0,fnFavRmv(e)}),BMS.SignIn.fnSignIn(!0)}catch(i){BMS.Misc.fnErr({fnName:"fnFavRmv",fnParams:e,err:i})}}function fnFavSuc(e){try{var t=unescape(e),n=BMS.Misc.fnGVal({key:"FAV",data:t});BMS.Storage;BMS.Storage.set({name:"userCine",key:"fav",value:n,storage:"C",sess:!1});var a=n.split(";");BMS.Storage.set({name:"ld",key:"FAV",value:n,storage:"C"}),_.each(a,function(e){$("#"+e).removeClass("animated infinite pulse zoomIn"),$("#"+e).addClass("_active"),$("#"+e).parent().parent().parent().addClass("_favourited"),$("#"+e).attr("onclick","fnFavRmv('"+e+"');")}),afterSignIn&&(render.showtimesRerender(),afterSignIn=!1)}catch(i){BMS.Misc.fnSCusErrDisplay({fnName:"fnFavSuc",fnParams:e,err:i})}}function GTMredirect(e,t,n,a,i,o,s){try{var r={event:"productClick",ecommerce:{currencyCode:"INR",click:{actionField:{list:"category"},products:[{name:e,id:t,category:"Movies",variant:s,position:o.attr("data-position"),dimension13:a}]}}};BMS.Misc.fnPushEventDataToAnalytics(["GA"],"productClick","",r)}catch(c){void 0}}function secondsTimeSpanToHMS(e){if(e>0){var t=Math.floor(e/3600);e-=3600*t;var n=Math.floor(e/60);e-=60*n,$("#spnTime").text(t+":"+(n<10?"0"+n:n)+":"+(e<10?"0"+e:e)+" left")}else blnTransCan=!1,$("#spnTime").text("Transaction Canceled"),$(".your-reservation-block").hide(),$("#PayOn,#CanBook").hide(),$(window).unbind("scroll"),clearInterval(intIntVal)}function fnCheckUnpaidBook(){var e="";if(BMS.Storage.isset({name:"ld"})){"Y"==BMS.Storage.get({name:"ld",key:"HASACTIVETRANS"});cutTime="",EventTitle="",eventCode="",venueName="",SeatInfo="",HasUnpaid=!1,"Y"!=BMS.Storage.get({name:"UNPAIDSUBSCRIPTION"})&&BMS.Misc.fnWsData({AppC:global.strAppCode,cmd:"GETMEMBERHISTORY",email:BMS.Storage.get({name:"ld",key:"MEMBEREMAIL"}),lsid:BMS.Storage.get({name:"ld",key:"LSID"}),data:"|MEMBERID="+BMS.Storage.get({name:"ld",key:"MEMBERID"})+"|UNPAID=Y|COD=Y|",blnSupp:!0,retType:"json",fnCC:function(t){var n=JSON.parse(decodeURIComponent(t));$.each(n.BookMyShow.arrBookingHistory,function(e,t){return void 0,"UP"==t.TransStatus&&(cutTime=t.Trans_strUPCutOffShowTime,HasUnpaid=!0,EventTitle=t.EventTitle,EventCode=t.Event_strCode,eventCode=t.Event_strCode,venueName=t.Cinema_strName,SeatInfo=t.SeatInfo,EventDate=t.ShowDate.replace(/-/g," ").substr(0,6),EventTime=t.ShowTime,TransId=t.TransId,BookID=t.BookingId,Vid=t.Venue_strCode,SSID=t.Session_lngSessionId,BookLngId=t.Booking_lngId,global.blnIsTouchScreen?$("#EvtDate").text(t.ShowDate.replace(/-/g," ").substr(0,6)):$("#EvtDate").text(t.ShowDate.replace(/-/g," "))),!1}),HasUnpaid&&(e+="<h3>Your Reservation</h3>",e+='<div class="event-details-container">',e+='<div class="event-image-container">',e+='<img src="'+global.strContentUrl+"/Events/moviecard/"+EventCode+'.jpg" alt="event">',e+="</div>",e+='<div class="event-text-container">',e+="<h4>"+EventTitle+'<span class="colon">:</span>',e+="</h4>",e+="<p>",e+='<span class="event-date"></span> '+EventDate+'| <span class="event-time"> '+EventTime+"</span>",e+="</p>",e+='<p class="venue-address">'+venueName+"<span> | </span></p>",e+='<div id="dTimerWrap" class="time-out">',e+="<div>",e+=global.blnIsTouchScreen?'Time left to confirm : <span id="spnTime">-:-:-</span></div>':'<span id="spnTime">-:-:-</span></div>',e+="</div>",e+="</div>",e+='<div class="button-container">',e+='<button class="pay-online" id="PayOn">PAY ONLINE</button>',e+='<button class="cancel-booking" id="CanBook">CANCEL BOOKING</button>',e+="</div>",e+="</div>",e+='<span id ="clsRes" class="__icon __close"> ',e+='<svg xml:space="preserve" enable-background="new 0 0 100 100" viewBox="0 0 100 100" y="0px" x="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" version="1.1">',e+='<use xlink:href="/icons/common-icons.svg#icon-cancel"/>\t',e+="</svg>",e+="</span>",$("#reserveBlock").html(e),$("#PayOn").attr("onclick","fnPayUnpaidTrans('"+TransId+"','"+BookID+"','"+Vid+"','"+SSID+"')"),$("#CanBook").attr("onclick","fnUnpaidCancelConf('"+TransId+"','"+BookLngId+"','"+Vid+"')"),BMS.Storage.set({name:"HasUnpaid",value:"Y",storage:"C"}),global.blnIsTouchScreen?$(".your-reservation-block").show():$(document).scroll(function(){var e=$(this).scrollTop();e>200?blnTransCan&&$(".your-reservation-block").fadeIn():$(".your-reservation-block").fadeOut()}),b=cutTime.split("2016")[1],c=b.substr(1,5)+" "+b.substr(6,8),CutoffDate=new Date(cutTime.split("2016")[0]+"2016 "+Converttimeformat(c)),starDate=new Date,exp=Math.floor((CutoffDate-starDate)/1e3),intIntVal=setInterval(function(){exp-=1,secondsTimeSpanToHMS(exp)},1e3)),$("#clsRes").on("click",function(){$(".your-reservation-block").hide(),BMS.Storage.set({name:"UNPAIDSUBSCRIPTION",value:"Y",storage:"C"}),blnTransCan=!1,clearInterval(intIntVal)})}})}}function fnUnpaidCancelConf(e,t,n){BMS.Storage.set({name:"HasUnpaid",value:"N",storage:"C"}),BMS.Misc.fnBusy(!0),BMS.Misc.fnGoTo("https://"+location.host+"/myprofile/booking-history")}function fnPayUnpaidTrans(e,t,n,a){BMS.Misc.fnPushEventDataToAnalytics(["WR","KM"],"Pay Reserved Seat",{ProductID:eventCode,"Event Name":EventTitle,"Event Type":"MT","Venue Name":venueName,Language:"","Seat Info":SeatInfo,Source:"Home",Genre:"",Appcode:global.strAppCode}),BMS.Misc.fnDoTrans({AppC:global.strAppCode,venCode:n,transId:e,cmd:"LOADUNPAIDBOOKING",fnCC:function(i){BMS.Storage.del({name:"pay_"+e,storage:"C"}),BMS.Storage.set({name:"lngTransId",value:e,storage:"C"}),BMS.Storage.set({name:"BOOKINGID",value:t,storage:"C"}),BMS.Storage.set({name:"HasUnpaid",value:"N",storage:"C"}),BMS.Misc.fnGoTo("https://"+location.host+"/payment/?cid="+n+"&sid="+a+"&ety=MT")},fnEC:function(e){}})}function Converttimeformat(e){var t=e,n=Number(t.match(/^(\d+)/)[1]),a=Number(t.match(/:(\d+)/)[1]),i=t.match(/\s(.*)$/)[1];"PM"==i&&n<12&&(n+=12),"AM"==i&&12==n&&(n-=12);var o=n.toString(),s=a.toString();return n<10&&(o="0"+o),a<10&&(s="0"+s),o+":"+s}function fnPushDLRecoStripEvent(e,t,n,a,i){if(e&&t){var o={event:e,eventname:t,venue:n?n:null,showtime:i?i:null,date:a?a:null};BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},o)}}function fnPushRecommendedViewToAnalytics(e,t){var n="Recommendation_view";switch(e){case"movie":var a=t.data("view-analytics"),i=a?a.split("',"):[];4==i.length&&fnPushDLRecoStripEvent(n+"_"+e,i[0],i[1],i[2],i[3]);break;case"experiences":case"blog":fnPushDLRecoStripEvent(n+"_"+e,t.data("view-analytics"))}}function fnShowRecommendedSection(){if(!global.blnIsTouchScreen){var e=$("#recommended-movie-strip"),t="movie";0==e.length&&(t="experiences",e=$("#recommended-"+t+"-strip"),0==e.length&&(t="blog",e=$("#recommended-"+t+"-strip"))),0!=e.length&&(e.show(),fnPushRecommendedViewToAnalytics(t,e))}}$(document).ready(function(){function e(){var e=$(location).attr("href"),t=BMS.Storage.get({name:"ld",key:"MEMBERID",storage:"C"}),n="";return n="Y"==BMS.Storage.get({name:"ld",storage:"C",key:"ISFCONNECTLOGIN"})?"FACEBOOK":"Y"==BMS.Storage.get({name:"ld",storage:"C",key:"ISPLUSLOGIN"})?"GPLUS":"EMAIL",userGender="M"===BMS.Storage.get({name:"ld",key:"GENDER",storage:"C"})?"MALE":"FEMALE",walletStats="A"===BMS.Storage.get({name:"ld",key:"WALLETSTATUS",storage:"C"})?"Yes":"No",visitorId=BMS.Storage.get({name:"ld",key:"MEMBERID",storage:"C"})?"Logged IN":"Guest Mode",{session_daypart:dayPart(),pagetype:pageName,pageurl:e,domain:"bms_web",navigatedfrom:pageName,visitor_id:t,user_mode:visitorId,user_gender:userGender,user_login_preference:n,user_last_transaction_date:"NA",user_walletuser:walletStats,user_wallet_balance:"NA",user_transaction_count:"NA",user_movie_transaction_count:"NA",app_code:global.strAppCode}}if(global.RgnCallBack.push(function(){blnIsRegionRouting=!0,BMS.Region.fnRedirectToRegionPage()}),global.SignInCallBack.push(function(){fnCheckWalletStatus()}),global.SignOutCallBack.push(function(){fnCheckWalletStatus()}),fnCheckUnpaidBook(),SAData.get(),"home"==pageName){videosData.get();var t=$(".popular-videos"),n=(t.find(".slick-slider"),t.find(".__video-card-container"),t.find(".view-all-btn"));t.find(".prev"),t.find(".next");t.on("click",".__video-card-container",function(){var e=$(this).find(".__card-content").children(".__video-name").attr("title"),t={event:"popularvideos_home_9",domain:"bms_web",pagetype:"Home page",discovery:"content_discovery",action:"click",pagesection:"videodetail",video_title:e};BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},t)}),n.click(function(){var e={event:"view_more_home_12",domain:"bms_web",pagetype:"Home page",discovery:"content_discovery",action:"click",pagesection:"videolistings",navigatedfrom:"Home page",navigatedto:"videos all page"};BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},e)}),t.on("click",".prev",function(){var e={event:"left_click_home_10",domain:"bms_web",pagetype:"Home page",discovery:"content_discovery",action:"click",pagesection:"Home page"};BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},e)}),t.on("click",".next",function(){var e={event:"right_click_home_11",domain:"bms_web",pagetype:"Home page",discovery:"content_discovery",action:"click",pagesection:"Home page"};BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},e)}),$(".adspot-content").find(".btn").mouseover(function(){$(this).css("background-color","#f4f4f4")}),$(".adspot-content").find(".btn").mouseout(function(){$(this).css("background-color","#fff")})}$('.adspot-content a[href="/offers/"]').on("click",function(){BMS.Misc.fnPushEventDataToAnalytics(["GA"],"",{},$.extend(e(),{event:"view_offers_home_13",discovery:"product_discovery",interaction:"navigation",action:"click",pagesection:"bms_pdtsec",navigatedto:"offers"}))}),$("#now-showing-carousel .movie-card.ns-card-recommended:visible").length>0&&BMS.Misc.fnPushEventDataToAnalytics(["WR","KM"],"Shown recommendation",{"No. of events recommended":$("#now-showing-carousel .movie-card.ns-card-recommended:visible").length,"Event types":"MT","Position Shown in":"Now Showing","Dates recommended":"",Appcode:global.strAppCode,Page:"home"}),global.initCarousels=function(){$("#now-showing-carousel .showcase-carousel, #coming-soon-carousel .showcase-carousel").slick({centerMode:!1,centerPadding:"250px",slidesToShow:3,slidesToScroll:3,dots:!1,autoplay:!1,pauseOnHover:!1,adaptiveHeight:!1,prevArrow:'<a class="buttons prev" aria-label="Previous" tabindex="0" role="button" href="javascript:;"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve"><use xlink:href="/icons/common-icons.svg#icon-go-back"></use></svg></a>',nextArrow:'<a class="buttons next" aria-label="Previous" tabindex="0" role="button" href="javascript:;"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve"><use xlink:href="/icons/common-icons.svg#icon-next-arrow"></use></svg></a>'})};var a=$("#now-showing-carousel").find(".banner-container"),i=a.length;0===i&&($(".col-just-for-you .__tab-row .button-now-showing").addClass("isEmpty"),$("#now-showing-carousel").addClass("isEmpty"));var o=$(".button-now-showing"),s=$(".button-coming-soon"),r=$(".carousel-now-showing"),c=$(".carousel-coming-soon");$("#now-showing-carousel").hasClass("isEmpty")?(s.addClass("_active"),c.css({opacity:1,height:"inherit"})):(o.click(function(){void 0,s.removeClass("_active"),$(this).addClass("_active"),c.css({opacity:0,height:"0px"}),r.css({opacity:1,height:"inherit"}),wow&&(wow.scrolled=!0,wow.scrollHandler())}),s.click(function(){void 0,o.removeClass("_active"),$(this).addClass("_active"),r.css({opacity:0,height:"0px"}),c.css({opacity:1,height:"inherit"}),wow&&(wow.scrolled=!0,wow.scrollHandler())})),fnCheckWalletStatus()});var videosDataab={get:function(){var e=12;BMS.Misc.fnAjax({dataType:"json",type:"GET",url:global.getDataUrl+"?cmd=GETTOPVIDEOS",data:{cardCount:e},success:function(e){videosDataab.process(e)},error:function(e){void 0}})},process:function(e){if(e&&("object"!=typeof e||0!=e.length)){var t,n,a,i,o,s,r="",c=$(".__video-list-ab"),l=e.data.MediaData;l.forEach(function(e){categoryName=e.category,n=e.urlCategory.toLowerCase().substring(2),t=n,a=e.title.length>65?e.title.slice(0,60)+"...":e.title,likesCount=e.likes,viewsCount=e.views,likeCount=0!=likesCount?"1"==likesCount?"1 like":likesCount+" likes":" ",viewCount=0!=viewsCount?"1"==viewsCount?"1 view":viewsCount+" views":" ",0!=likesCount&&(r='<div class="__left-action">\t\t\t\t\t<span class="__text">'+likeCount+"</span>\t\t\t\t\t</div>"),0!=viewsCount&&(o='<div class="__right-action">\t\t\t\t\t<span class="__text">'+viewCount+"</span>\t\t\t\t\t</div>"),n="tv"==n?"tv-news":"style"==n?"fashion-lifestyle":"bollywood",i="/videos/"+n+"/"+e.urlTitle+"/"+e.videoID;var l=global.blnIsTouchScreen?'<img data-mobile="'+e.imageURL+'"  alt="'+e.title+'" data-error="//in.bmscdn.com/events/moviecard/noimage.jpg" />':'<img data-lazy="'+e.imageURL+'" alt="'+e.title+'" data-error="//in.bmscdn.com/events/moviecard/noimage.jpg" />';s=$(BMS.Misc.Helpers.render(videosDataab.template,{videoURL:i,imageURL:e.imageURL,categoryClass:t,categoryName:categoryName,title:e.title,clippedTitle:a,likeHTML:r,viewHTML:o,imgTag:l})),c.append(s)}),global.blnIsTouchScreen||videosDataab.initVideoCarousel()}},template:'<div class="__video-card-container _card-col wow" data-wow-offset="-200">\t\t\t\t\t<div class="__card-container _video-card">\t\t\t\t\t\t<a href="{{videoURL}}">\t\t\t\t\t\t\t\t<div class="__card-img">\t\t\t\t\t\t\t\t\t{{imgTag}}\t\t\t\t\t\t\t\t\t<div class="__overlay-container">\t\t\t\t\t\t\t\t\t\t<div class="__block">\t\t\t\t\t\t\t\t\t\t\t<div class="__play-button">\t\t\t\t\t\t\t\t\t\t\t\t<div class="__btn"></div>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="__card-category _{{categoryClass}}">\t\t\t\t\t\t\t\t\t\t\t\t{{categoryName}}\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div class="__card-content">\t\t\t\t\t\t\t\t\t<div class="__video-name" title="{{title}}">\t\t\t\t\t\t\t\t\t\t{{clippedTitle}}\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class="__likes-votes">\t\t\t\t\t\t\t\t\t\t{{likeHTML}}\t\t\t\t\t\t\t\t\t\t{{viewHTML}}\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</a>\t\t\t\t\t</div>\t\t\t\t</div>',initVideoCarousel:function(){var e=$("#popular-videos-ab");e.slick({centerMode:!1,slidesToShow:4,slidesToScroll:4,infinite:!0,dots:!1,autoplay:!1,adaptiveHeight:!1,responsive:[{breakpoint:1400,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:1150,settings:{slidesToShow:2,slidesToScroll:2}}],prevArrow:'<div class="prev"></div>',nextArrow:'<div class="next"></div>'})}},videosData={get:function(){var e=12;BMS.Misc.fnAjax({dataType:"json",type:"GET",url:global.getDataUrl+"?cmd=GETTOPVIDEOS",data:{cardCount:e},success:function(e){videosData.process(e)},error:function(e){void 0}})},process:function(e){if(e&&("object"!=typeof e||0!=e.length)){var t,n,a,i,o,s,r="",c=$(".__video-list"),l=e.data.MediaData;l.forEach(function(e){categoryName=e.category,n=e.urlCategory.toLowerCase().substring(2),t=n,a=e.title.length>65?e.title.slice(0,60)+"...":e.title,likesCount=e.likes,viewsCount=e.views,likeCount=0!=likesCount?"1"==likesCount?"1 like":likesCount+" likes":" ",viewCount=0!=viewsCount?"1"==viewsCount?"1 view":viewsCount+" views":" ",0!=likesCount&&(r='<div class="__left-action">\t\t\t\t\t<span class="__text">'+likeCount+"</span>\t\t\t\t\t</div>"),0!=viewsCount&&(o='<div class="__right-action">\t\t\t\t\t<span class="__text">'+viewCount+"</span>\t\t\t\t\t</div>"),n="tv"==n?"tv-news":"style"==n?"fashion-lifestyle":"bollywood",i="/videos/"+n+"/"+e.urlTitle+"/"+e.videoID;var l=global.blnIsTouchScreen?'<img data-mobile="'+e.imageURL+'"  alt="'+e.title+'" data-error="//in.bmscdn.com/events/moviecard/noimage.jpg" />':'<img data-lazy="'+e.imageURL+'" alt="'+e.title+'" data-error="//in.bmscdn.com/events/moviecard/noimage.jpg" />';s=$(BMS.Misc.Helpers.render(videosData.template,{videoURL:i,imageURL:e.imageURL,categoryClass:t,categoryName:categoryName,title:e.title,clippedTitle:a,likeHTML:r,viewHTML:o,imgTag:l})),c.append(s)}),global.blnIsTouchScreen||videosData.initVideoCarousel()}},template:'<div class="__video-card-container _card-col wow" data-wow-offset="-200">\t\t\t\t\t<div class="__card-container _video-card">\t\t\t\t\t\t<a href="{{videoURL}}">\t\t\t\t\t\t\t\t<div class="__card-img">\t\t\t\t\t\t\t\t\t{{imgTag}}\t\t\t\t\t\t\t\t\t<div class="__overlay-container">\t\t\t\t\t\t\t\t\t\t<div class="__block">\t\t\t\t\t\t\t\t\t\t\t<div class="__play-button">\t\t\t\t\t\t\t\t\t\t\t\t<div class="__btn"></div>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t<div class="__card-category _{{categoryClass}}">\t\t\t\t\t\t\t\t\t\t\t\t{{categoryName}}\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div class="__card-content">\t\t\t\t\t\t\t\t\t<div class="__video-name" title="{{title}}">\t\t\t\t\t\t\t\t\t\t{{clippedTitle}}\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class="__likes-votes">\t\t\t\t\t\t\t\t\t\t{{likeHTML}}\t\t\t\t\t\t\t\t\t\t{{viewHTML}}\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</a>\t\t\t\t\t</div>\t\t\t\t</div>',initVideoCarousel:function(){var e=$("#popular-videos");e.slick({centerMode:!1,slidesToShow:4,slidesToScroll:4,infinite:!0,dots:!1,autoplay:!1,adaptiveHeight:!1,responsive:[{breakpoint:1400,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:1150,settings:{slidesToShow:2,slidesToScroll:2}}],prevArrow:'<div class="prev"></div>',nextArrow:'<div class="next"></div>'})}},SAData={get:function(){global.SAEventCodes&&BMS.Misc.fnAjax({dataType:"json",type:"POST",url:global.getDataUrl+"?cmd=GETSADATA",data:{events:global.SAEventCodes},success:function(e){SAData.process(e)},error:function(e){void 0}})},process:function(e){e&&("object"==typeof e&&0==e.length||($(".sa-data-plugin").each(function(){if($(this).data("coming-soon"))var t=$(this).data("event-code");else var t=$(this).data("event-group");var n=e[t];n&&(n.totalVotes>0?SAData.renderHearts.call(this,n):n.totalWTSCount>0&&$(this).data("coming-soon")?SAData.renderThumbs.call(this,n):SAData.renderNR.call(this,n))}),global.blnIsTouchScreen||global.initCarousels()))},renderHearts:function(e){var t=$(this);t.find(".__heart").removeClass("_none"),t.find(".__percentage").html(e.avgRating+"%"),t.find(".__count").html(e.totalVotes+function(){return e.totalVotes>1?" votes":" vote"}())},renderThumbs:function(e){var t=$(this);t.find(".__thumbs").removeClass("_none"),t.find(".__percentage").html(e.wtsPerc+"%"),t.find(".__count").html(e.totalWTSCount+function(){return e.totalWTSCount>1?" votes":" vote"}())},renderNR:function(e){var t=$(this);t.find(".__thumbs").addClass("_none"),t.find(".__heart").addClass("_none"),t.find(".__percentage").html(""),t.find(".__count").html(""),t.hasClass("_top10")&&(t.find(".__heart").removeClass("_none").html(" "),t.find(".__percentage").html("NR"))}};if(blnCallSeatHtml=!1,global.blnIsTouchScreen){var currentGeoLocation;currentGeoLocation={geoLocation:{}};var getLocation=function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(showPosition)}();!function(e){void 0;var t={},n={},a={},i={},o={venueListing:{}},s={flags:{showtimes:{}}},r={};t={sanitize:{date:function(e){return new Date(e.substr(0,4)+"/"+e.substr(4,2)+"/"+e.substr(6,2)+" "+e.substr(8,2)+":"+e.substr(10,2))},time:function(e){var t=e.getHours(),n=e.getMinutes(),a=!1;return t>12?(t-=12,a=!0):12==t?a=!0:0==t&&(t=12),n<10&&(n="0"+n),a=a?"pm":"am",t+":"+n+" "+a},"boolean":function(e){return"string"==typeof e?"Y"==e?e=!0:"N"==e?e=!1:e:("object"!=typeof e&&"array"!=typeof e||_.each(e,function(n,a){e[a]=t.sanitize["boolean"](n)}),e)}},venueName:function(e){return e.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"").replace(/\s/g,"-").toLowerCase()+"/cinema"},render:function(t,n,a){t=e("#"+t).html().split("\n").join("");var i,o,s,r,c,l,d=/([$\^\\\/()|?+*\[\]{}.\-])/g;return a=a||{},l="{{}}",r=l.length,c=Math.ceil(r/2),o=l.substr(0,c).replace(d,"\\$1"),s=l.substr(c,r).replace(d,"\\$1")||o,i=new RegExp(o+"[^"+o+s+"]+"+s,"g"),t.replace(i,function(e){var t,a=e.slice(c,-c),i=a.split("."),o=0,s=i.length;if(a in n)t=n[a];else for(t=n;o<s;o++){if(!(i[o]in t))return e;t=t[i[o]]}return t})},difference:function(e){for(var t=[],n=e.length-1,a=0;a<e.length-1;a++)if(a!=n)return parseInt(e[a])>parseInt(e[a+1])?t.push(parseInt(e[a])-parseInt(e[a+1])):t.push(parseInt(e[a+1])-parseInt(e[a]))},getLatLongDistance:function(e,t){var n=e.lat,a=t.lat,i=e.lng,o=t.lng,s=function(e){return e*(Math.PI/180)},r=6371,c=s(a-n),l=s(o-i),d=Math.sin(c/2)*Math.sin(c/2)+Math.cos(s(n))*Math.cos(s(a))*Math.sin(l/2)*Math.sin(l/2),v=2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),u=r*v;return u.toFixed(2)},between:function(e,t){var n=Math.min.apply(Math,[e,t]),a=Math.max.apply(Math,[e,t]);return this>n&&this<a},getCatAvailability:function(e){e=parseInt(e),e<0&&(e=0);for(var t=0;t<availSeatRange.length;t++){var n=function(){var n=availSeatRange[t].range.split("-");return e>=parseInt(n[0])&&e<=parseInt(n[1])}();if(n)return availSeatRange[t]}}},Array.prototype.equals=function(e){if(!e)return!1;if(this.length!=e.length)return!1;for(var t=0,n=this.length;t<n;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!=e[t])return!1;return!0},e.extend(window,{helpers:t,models:n,presenters:i,views:a,render:s,events:r,dom:o});var c=cinemaListAPI.BookMyShow.aiVN;n.venues=function(){var e={};return c.forEach(function(t){e[t.VenueCode]={id:t.VenueCode,name:t.VenueName,address:t.VenueAddress,legends:t.VenueLegends,subRegion:t.RegionCode,CinemaUnpaidFlag:t.CinemaUnpaidFlag,geoLocation:{lat:t.VenueLatitude,lng:t.VenueLongitude}}}),e}();var l={flat:{fav:150,rec:40,pop:25,mrb:45,mrs:40,off:-100}};i.rankVenues=function(){var a=BMS.Storage.get({name:"userCine"}).split("|"),i=[],o=[],r=[],c=[],d=[],v={};_.each(a,function(e){if(e.search("fav=")>=0)i=e.replace("fav=","").split(";");else if(e.search("pop=")>=0)if(BMS.Storage.isset({name:"ld"}))o=[];else{o=e.replace("pop=","").split(";");var t=o.length-1;_.each(o,function(e){""!=e&&(v[e]=t,t--)})}else e.search("mrb=")>=0?r=e.replace("mrb=","").split(";"):e.search("mrs=")>=0&&(c=e.replace("mrs=","").split(";"))}),window._ranks={fav:i,rec:d,pop:o,mrb:r,mrs:c};try{afterSignInCallback&&(e(".list>.cinema-info").find(".cinema-details").find(".cine-heart").removeClass("_active"),e(".list").removeClass("_favourited"),_.each(i,function(t){e("#"+t).removeClass("animated infinite pulse zoomIn"),e("#"+t).addClass("_active"),e("#"+t).parent().parent().parent().addClass("_favourited"),e("#"+t).attr("onclick","fnFavRmv('"+t+"');")}))}catch(u){}var g={};_.each(_ranks,function(e,t){_.each(e,function(e){var n=l.flat[t];"undefined"==typeof g[e]&&(g[e]=0),"undefined"!=typeof v[e]&&(n+=v[e]),g[e]+=n})});var f=[];_.each(n.venues,function(e,t){var n=function(){return g[t]?g[t]:0}();f.push({id:t,score:n})});var p=_.max(f,function(e){return e.score}),m=!1;0==p.score&&(m=!0),navigator.geolocation&&void 0!=currentGeoLocation.geoLocation.lat&&void 0!=currentGeoLocation.geoLocation.lng&&void 0==n.venues[p.id].distanceFromMyLoc&&(n.venues[p.id].distanceFromMyLoc=t.getLatLongDistance(currentGeoLocation.geoLocation,n.venues[p.id].geoLocation)),_.each(f,function(e,a){if(e.id!=p.id){n.venues[e.id].score=0;var i,o;!BMS.Storage.isset({name:"ld"})&&navigator.geolocation&&void 0!=currentGeoLocation.geoLocation.lat&&void 0!=currentGeoLocation.geoLocation.lng?(i=35,o=currentGeoLocation.geoLocation,m||(p.score+=100)):navigator.geolocation&&BMS.Storage.isset({name:"ld"})?(i=35,o=currentGeoLocation.geoLocation,m||(p.score+=100)):(i=10,o=n.venues[p.id].geoLocation,p.score+=100);var s=function(){var a=t.getLatLongDistance(o,n.venues[e.id].geoLocation);return n.venues[e.id].distanceFromMyLoc=a,a=a<100?i-a/100*i:0}();e.score+=s,n.venues[e.id].score+=s}}),window._sortedCandidates=_.sortBy(f,function(e){return-e.score});var S=[];_.each(_sortedCandidates,function(e,t){n.venues[e.id].rank=t,S.push(e.id)}),n.venueRanking&&(S.equals(_.map(n.venueRanking,function(e){return e.id}))||(s.flags.showtimes.listing=!1)),n.venueRanking=_sortedCandidates},s.venueListing=function(){"undefined"==typeof o.venueListing.venues&&(o.venueListing.venues={}),_.each(n.venues,function(n){var a,i,s=n.id,r=n.name,c=n.address,l=(n.venueApp,t.venueName(n.name)),d="",i="",v="",u="fnFavAdd('"+s+"')",g="";""!=_ranks.fav?_.each(_ranks.fav,function(e){if(s==e)return a="_active",i="_favourited",void(u="fnFavRmv('"+s+"')")}):(a="",i="",u="fnFavAdd('"+s+"')"),"Y"===n.CinemaUnpaidFlag&&(g=t.render("temp-touch-unpaid")),o.venueListing.venues[n.id]=e(t.render("temp-venues",{VenueURL:s,VenueName:r,VenueURLName:l,venueCode:n.id,isRecommended:d,isfavClass:i,isVenueInfo:v,address:c,favfunctionToCall:u,isFav:a,unpaidContent:g}))});var a=_.map(n.venueRanking,function(e){return o.venueListing.venues[e.id]});o.venueListing.listing=e('<ul class="cinemas-list"><ul/>'),o.venueListing.listing.append(a),e(".cinema-listing").html(o.venueListing.listing),e(".cn-st-distance").hide()},s.showtimesRerender=function(){i.rankVenues();var t=_.map(n.venueRanking,function(e){return o.venueListing.venues[e.id].find(".cinema-details").find(".__name").find(".__distance").html(n.venues[e.id].distanceFromMyLoc+" km"),o.venueListing.venues[e.id]});o.venueListing.listing=e('<ul class="cinemas-list"><ul/>'),o.venueListing.listing.append(t),e(".cinema-listing").html(o.venueListing.listing)},i.rankVenues(),s.venueListing()}(jQuery);var afterSignIn=!1;global.SignInCallBack.push(function(){$("body,html").animate({scrollTop:0},700),afterSignIn||(render.showtimesRerender(),afterSignInCallback=!0)}),global.SignOutCallBack.push(function(){afterSignIn=!1,afterSignInCallback=!1,setTimeout(function(){render.showtimesRerender()},1e3)}),global.RgnCallBack.push(function(){loadURL(location)})}for(var a_div=$("#now-showing-carousel").find("div.banner-container").not("div.slick-cloned").find("a[class='__movie-name']"),k=0;k<a_div.length;k++)a_div.eq(k).attr("data-position",k+1);blnTransCan=!0,intIntVal=0,$(document).ready(function(){var e=function(t,n){if($(".card-ratings").length<=0)return!1;var a=[];$("[data-role=ratingStars]").each(function(){$.inArray($(this).attr("event-code"),a)==-1&&a.push($(this).attr("event-code"))}),$(".rating-container").hide(),""!=t&&BMS.Misc.fnBusy(!0),BMS.Ratings.fnIsMovieRated(a,function(a){if(""!=t&&BMS.Misc.fnBusy(!1),$(".rating-container").show(),""==a.msg){var i=!1;$.each(a.details,function(e,n){if(null!=n&&0==n.error.code){if("undefined"==typeof BMS.Ratings.eventData&&(BMS.Ratings.eventData={}),e==t&&"undefined"!=typeof n.data.Reviews.Title&&""!=n.data.Reviews.Title&&"undefined"!=typeof n.data.Reviews.Review&&""!=n.data.Reviews.Review)i=!0;else if(e==t&&"undefined"!=typeof n.data.Reviews.ReviewId){var a=n.data.Reviews.ReviewId;"undefined"!=typeof a&&""!=a?BMS.Ratings.eventData.reviewId=a:BMS.Ratings.eventData.reviewId="",
BMS.Ratings.eventData.starRating=parseFloat(n.data.Reviews.Rating/20)}if("undefined"!=typeof n.data.Reviews.Title&&""!=n.data.Reviews.Title&&"undefined"!=typeof n.data.Reviews.Review&&""!=n.data.Reviews.Review)$("[cont-id='cnt"+e+"']").hide();else{$("#d"+e).attr("data-review-id",n.data.Reviews.ReviewId);var o=n.data.Reviews.Rating/20;$(".card-ratings").find("[data-event-code='"+e+"']").attr("data-value",o).html(o),$("#d"+e+" .ratingSpan").each(function(){$(this).attr("data-value")<=o?$(this).addClass("selected").find("use").css({fill:"#f3c600"}):$(this).removeClass("selected").find("use").css({fill:"#e0e0e0"})}),$("#d"+e).next(".rating-head").text("Write a review")}}}),1==n&&(0==i?BMS.Ratings.fnPreModalInit():1==i&&($("#popover-rating-msg").html("You have already rated the event once."),BMS.Misc.modal("review-rating-response",!0)))}global.SignOutCallBack.push(function(){BMS.SignIn.fnRegister("card-ratings",function(){e("",0)}),$(".rating-container").show()})})};$("#submitBtnRnR").on("click",function(){BMS.Ratings.fnSubmitRatings(function(e,t){if(e);else if("undefined"!=typeof t.isReviewed)if(1==t.isReviewed)$("[cont-id='cnt"+BMS.Ratings.eventData.strEventCode+"']").hide();else if(0==t.isReviewed&&"undefined"!=typeof t.data.Reviews){$("#d"+BMS.Ratings.eventData.strEventCode).attr("data-review-id",t.data.Reviews.reviewId);var n=BMS.Ratings.eventData.starRating;$(".card-ratings").find("[data-event-code='"+BMS.Ratings.eventData.strEventCode+"']").attr("data-value",n).html(n),$("#d"+BMS.Ratings.eventData.strEventCode+" .ratingSpan").each(function(){$(this).attr("data-value")<=n?$(this).addClass("selected").find("use").css({fill:"#f3c600"}):$(this).removeClass("selected").find("use").css({fill:"#e0e0e0"})}),$("#d"+BMS.Ratings.eventData.strEventCode).next(".rating-head").text("Write a review")}})}),$(".card-ratings .ratingSpan").on("click",function(){var t=BMS.Storage.isset({name:"ld"}),n=$(this).parents(".rating-stars").attr("event-code"),a=$(this).parents(".rating-stars").attr("event-name"),i=$(this).parents(".card-ratings").find(".rate-o-meter").attr("data-value");if(BMS.Ratings.eventData={strEventCode:n,strEventName:a,starRating:parseFloat(i)},t){var o=$(this).parents(".rating-stars").attr("data-review-id");"undefined"!=typeof o&&""!=o?(BMS.Ratings.blnExpandReview=!0,BMS.Ratings.eventData.reviewId=o):(BMS.Ratings.blnExpandReview=!1,BMS.Ratings.eventData.reviewId=""),BMS.Ratings.fnPreModalInit()}else{BMS.Misc.modal("signinPopup",!0);var s=n;BMS.SignIn.fnRegister("card-ratings",function(){e(s,1)})}}),BMS.Storage.isset({name:"ld"})&&e("",0),BMS.SignIn.fnRegister("card-ratings",function(){e("",0)})}),BMS.Ratings.blnExpandReview=!1,BMS.Ratings.fnSubmitRatings=function(e){try{var t=parseFloat($("#popover-score").attr("data-value")),n=$.trim($("#review-title").val()),a=$.trim($("#review-text").val());if(BMS.Ratings.eventData.starRating=t,t=20*t,t<=0)return BMS.Misc.fnSCusErrDisplay("popover-rating-num-error","Rating is compulsory","e"),$("#popover-rating-num-error").css("display","inline-block"),void $("#popover-rating-num-error").css("margin-bottom","10px");if(""!=n&&n!=$("#review-title").attr("placeholder")||""!=a&&a!=$("#review-text").attr("placeholder")){if(""==n||n==$("#review-title").attr("placeholder"))return BMS.Misc.fnSCusErrDisplay("popover-rating-error","Title is compulsory in case you want to provide review","e"),void $("#review-title").focus();if(""==a||a==$("#review-text").attr("placeholder"))return BMS.Misc.fnSCusErrDisplay("popover-rating-error","Review text is compulsory in case you want to provide review","e"),void $("#review-text").focus();if(!(""==n&&n==$("#review-title").attr("placeholder")||""==a&&a==$("#review-text").attr("placeholder"))){var i={cmd:"INSREVIEW",rt:n,rtxt:a,eid:BMS.Ratings.eventData.strEventCode,er:t};"undefined"!=typeof BMS.Ratings.eventData.reviewId&&""!=BMS.Ratings.eventData.reviewId&&(i.rid=BMS.Ratings.eventData.reviewId)}}else{var i={cmd:"INSEVRATE",eid:BMS.Ratings.eventData.strEventCode,er:t};"undefined"!=typeof BMS.Ratings.eventData.reviewId&&(i.rid=BMS.Ratings.eventData.reviewId)}if(""!=a&&a.length<140)return BMS.Misc.fnSCusErrDisplay("popover-rating-error","Review must be atleast 140 characters","e"),void $("#review-text").focus();BMS.Misc.fnBusy(!0,BMS.Modal.currentModal),BMS.Misc.fnAjax({url:location.protocol+"//"+location.host+global.getDataUrl,type:"GET",dataType:"json",data:i,success:function(t){if(BMS.Misc.fnBusy(!1,BMS.Modal.currentModal),"INSEVRATE"==i.cmd){var n=t.error.text;0==t.error.code||13==t.error.code||44==t.error.code?(t.isReviewed=!1,$("#popover-rating-msg").html(n),BMS.Misc.modal("review-rating-response",!0),setTimeout(function(){$("#review-rating-response .__dismiss").click()},2e3)):($("#popover-rating-error").html(n).show().addClass("_error"),BMS.Misc.modal("reviewRating",!0))}else{var n=t.error.text;0==t.error.code||20==t.error.code||45==t.error.code?(t.isReviewed=!0,$("#popover-rating-msg").html(n),BMS.Misc.modal("review-rating-response",!0),setTimeout(function(){$("#review-rating-response .__dismiss").click()},2e3)):($("#popover-rating-error").html(n).show().addClass("_error"),BMS.Misc.modal("reviewRating",!0))}BMS.Misc.fnPushEventDataToAnalytics&&i&&i.eid&&i.er&&BMS.Misc.fnPushEventDataToAnalytics(["WR","KM"],"Rated",{ProductID:i.eid,Rating:i.er,"Event Type":"","Event Name":"",Language:"",Genre:"",Appcode:global.strAppCode}),e(null,t)},error:function(t){BMS.Misc.fnBusy(!1,BMS.Modal.currentModal),BMS.Misc.fnSCusErrDisplay("popover-rating-error",t,"e"),e(t,null)}})}catch(o){BMS.Misc.fnErr({fnName:"BMS.Ratings.fnSubmitRatings",err:o})}},BMS.Ratings.fnPreModalInit=function(){try{$("#spnRatingMovieTitle").html(BMS.Ratings.eventData.strEventName),$("#popover-score").attr("data-value",BMS.Ratings.eventData.starRating),$("#popover-score").html(BMS.Ratings.eventData.starRating),$("#popover-stars .ratingSpan").each(function(){$(this).attr("data-value")<=BMS.Ratings.eventData.starRating?$(this).addClass("selected").find("use").css({fill:"#f3c600"}):$(this).removeClass("selected").find("use").css({fill:"#e0e0e0"})}),"undefined"!=typeof BMS.Ratings.eventData.reviewId&&""!=BMS.Ratings.eventData.reviewId?$("#popover-stars").attr("data-review-id",BMS.Ratings.eventData.reviewId):$("#popover-stars").removeAttr("data-review-id"),$("#popover-rating-num-error").html("").hide(),1==BMS.Ratings.blnExpandReview?BMS.Ratings.expandReview():BMS.Ratings.collapseReview(),BMS.Misc.modal("reviewRating",!0)}catch(e){BMS.Misc.fnErr({fnName:"BMS.Ratings.fnPreModalInit",err:e})}},BMS.Ratings.fnIsMovieRated=function(e,t){"object"==typeof e&&0!=e.length&&BMS.Misc.fnAjax({url:global.getDataUrl,type:"GET",dataType:"json",data:{cmd:"CHKUSERREVIEW",event_codes:e},success:function(e){t(e)},error:function(e){BMS.Misc.fnErr({fnName:"BMS.Ratings.fnIsMovieRated-fnAjax.error",err:e})}})},BMS.Ratings.fnCheckRatings=function(e,t){try{var n=[];"undefined"!=typeof t&&""!=t?n=t:$("[data-role=ratingStars]").each(function(){$.inArray($(this).attr("event-code"),n)==-1&&n.push($(this).attr("event-code"))}),BMS.Misc.fnAjax({url:global.getDataUrl,type:"GET",dataType:"json",data:{cmd:"CHKUSERREVIEW",event_codes:n},success:function(t){e(null,t)},error:function(t){e(t,null)}})}catch(a){BMS.Misc.fnErr({fnName:"BMS.Ratings.fnCheckRatings",err:a})}},BMS.Ratings.fnCheckReviewTxt=function(e){try{var t=140-$(e).val().length;if(t<0)return $("#review-count-span").hide(),!1;$("#review-count-span").show(),$("#review-chars-count").html(t)}catch(n){BMS.Misc.fnErr({fnName:"BMS.Ratings.fnCheckReviewTxt",err:n})}},BMS.Ratings.fnUserEventDetails=function(e,t){try{if("object"!=typeof e||0==e.length)return!1;BMS.Misc.fnAjax({url:global.getDataUrl,type:"GET",dataType:"json",data:{cmd:"USEREVENTDETAILS",event_codes:e},success:function(e){"undefined"!=typeof t&&t(e)},error:function(e){BMS.Misc.fnErr({fnName:"BMS.Ratings.fnUserEventDetails-fnAjax.error",err:e})}})}catch(n){BMS.Misc.fnErr({fnName:"BMS.Ratings.fnUserEventDetails",err:n})}},BMS.Ratings.expandReview=function(){try{var e=($("#div-review-form").show(),$("#div-overall-rating > svg use")),t=$("#div-review-form");e.attr("xlink:href","/icons/common-icons.svg#icon-minus"),t.show(),$("#review-title").val("").focus(),$("#review-text").val(""),$("#popover-rating-error").html("").hide()}catch(n){BMS.Misc.fnErr({fnName:"BMS.Ratings.expandReview",err:n})}},BMS.Ratings.collapseReview=function(){try{var e=($("#div-review-form").hide(),$("#div-overall-rating > svg use")),t=$("#div-review-form");e.attr("xlink:href","/icons/common-icons.svg#icon-plus"),t.hide(),$("#review-title").val("").focus(),$("#review-text").val(""),$("#popover-rating-error").html("").hide()}catch(n){BMS.Misc.fnErr({fnName:"BMS.Ratings.expandReview",err:n})}},$(document).ready(function(){$("#div-overall-rating").on("click",function(){var e=$("#div-review-form").css("display"),t=$("#div-overall-rating > svg use"),n=$("#div-review-form");"none"==e?(t.attr("xlink:href","/icons/common-icons.svg#icon-minus"),n.slideDown(200)):(t.attr("xlink:href","/icons/common-icons.svg#icon-plus"),n.slideUp(500)),$("#review-title").val("").focus(),$("#review-text").val(""),$("#popover-rating-error").html("").hide()}),$("#popover-stars .ratingSpan svg").on("click",function(){$("#popover-rating-num-error").hide()})});